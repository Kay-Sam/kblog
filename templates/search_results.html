{% extends "base.html" %}

{% block title %}Search Results for "{{ query }}"{% endblock %}

{% block content %}
<div class="container mt-4">
    <h3>Search Results for: "<strong>{{ query }}</strong>"</h3>

    {% if results %}
        {% for blog in results %}
           <div class="blog-card-custom">
            {% if blog.image_filename %}
                <img src="{{ url_for('static', filename='uploads/' + blog.image_filename) }}" alt="Blog Image" class="blog-image-custom">
            {% endif %}
            <div class="blog-content-custom">
                <h2 class="blog-title-custom">{{ blog.title }}</h2>
                <p class="blog-description-custom"> {{ blog.description.split()[:20] | join(' ') }}
                                        {% if blog.description.split()|length > 20 %}...{% endif %}</p>
                <small class="blog-meta-custom">
                    <i class="fas fa-user"></i> Posted by {{ blog.user.username }} on {{ blog.date_published.strftime('%B %d, %Y') }}
                </small>
              <a href="{{ url_for('view_blog', blog_id=blog.id) }}" class="btn btn-info btn-sm mt-2">Read More</a>
 <a href="{{ url_for('view_blog', blog_id=blog.id) }}" class="">
        <i class="fas fa-comments"></i> {{ blog.comments|length }} comment{{ '' if blog.comments|length == 1 else 's' }}
    </a>
                {% if session['user_id'] == blog.user.id %}
                <div class="blog-actions-custom">
                    <a href="{{ url_for('edit_blog', blog_id=blog.id) }}" class="btn btn-primary btn-sm">Edit</a>
                    <form action="{{ url_for('delete_blog', blog_id=blog.id) }}" method="POST" class="d-inline">
                        <button type="submit" class="btn btn-danger btn-sm" onclick="return confirm('Are you sure you want to delete this post?')">Delete</button>
                    </form>
                </div>
                {% endif %}
            </div>
        </div>
    {% else %}
        <p class="no-blogs">No blog posts available.</p>
        {% endfor %}
    {% else %}
        <p class="text-muted">No blog posts found for "<strong>{{ query }}</strong>".</p>
    {% endif %}
</div>
{% endblock %}
